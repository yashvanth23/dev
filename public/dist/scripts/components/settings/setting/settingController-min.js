+function(e,o){"use strict";function r(r,a,i,n,t,s){r.initFunction=function(){r.userData=JSON.parse(e.sessionStorage.userDetail),r.settingDrop=!1,r.genderError=!1,r.profileEdit=!1,r.changePass={oldPass:"",newPass:""},a.loader=!0,r.profileInfo={name:"",email:"",notification:!1,mobile:"",gender:"",address:"",city:"",state:"",pincode:"",country:"",avatar:r.userData.avatar},r.customError=!1,r.getProfileInformation()},r.getProfileInformation=function(){var e=a.appConfig.baseUrl+a.appConfig.profile+"/"+r.userData._id;t.get(e).then(function(e){a.loader=!1,e&&"success"==e.data.status?(r.profile=e.data.data,r.profileInfo.name=r.profile.name,r.profileInfo.email=r.profile.email,r.profileInfo.mobile=r.profile.mobileNumber,r.profileInfo.gender=r.profile.gender,r.profileInfo.address=r.profile.address.line1,r.profileInfo.city=r.profile.address.city,r.profileInfo.state=r.profile.address.state,r.profileInfo.pincode=r.profile.address.pincode,r.profileInfo.country=r.profile.address.country,r.profileInfo.notification=r.profile.pushNotification):i.showError("#errorModal",e.data.error,!0)},function(e){i.showError("#errorModal",e,!0)})},r.updateProfile=function(e){r.submitForm=!0;var o=!1;if(""!=r.profileInfo.gender?(r.genderError=!1,o=!1):(r.genderError=!0,o=!0),e&&o){a.loader=!0;var n=a.appConfig.baseUrl+a.appConfig.updateProfile,s={_id:r.userData._id,name:r.profileInfo.name,gender:r.profileInfo.gender,mobileNumber:r.profileInfo.mobile,address:{line1:r.profileInfo.address,city:r.profileInfo.city,state:r.profileInfo.state,pincode:r.profileInfo.pincode,country:r.profileInfo.country},pushNotification:r.profileInfo.notification};t.post(n,s).then(function(e){a.loader=!1,e&&"success"==e.data.status?(r.profile=e.data.data,r.submitForm=!1,i.showError("#successModal","Profile Updated Successfully",!0),r.getProfileInformation()):i.showError("#errorModal",e.data.error,!0)},function(e){i.showError("#errorModal",e,!0)})}},r.changePasswordOpen=function(){o.element(".setting-modal").addClass("active"),r.settingDrop=!0},r.changePasswordClose=function(){o.element(".setting-modal").removeClass("active"),r.settingDrop=!1},r.addProfile=function(){document.getElementById("avatar").click()},r.onLoad=function(e,o,a,n,t,f){try{"unsupported"==e?i.showError("Sorry, the uploaded file type is not supported. Please choose a JPEG (or) PNG type image."):f&&f.filetype&&"image"==f.filetype.split("/")[0]&&(r.picture=f,r.profileBase=f.base64,r.profileInfo.avatar=f.base64)}catch(e){s.promiseRejectsAfterAWhile(e)}},r.changePassword=function(e){if(r.passwordChange=!0,e){a.loader=!0;var o=a.appConfig.baseUrl+a.appConfig.changePassword,n={username:r.userData.username,oldPassword:r.changePass.oldPass,newPassword:r.changePass.newPass};t.post(o,n).then(function(e){a.loader=!1,e&&"success"==e.data.status?(r.passwordChange=!1,console.log(e.data.data),i.showError("#successModal","Password Changed Successfully",!0)):i.showError("#errorModal",e.data.error,!0)},function(e){i.showError("#errorModal",e,!0)})}},r.enableProfile=function(){r.profileEdit?r.profileEdit=!1:r.profileEdit=!0},r.initFunction()}o.module("fandom").registerCtrl("settingCtrl",r),r.$inject=["$scope","$rootScope","$commons","$logger","fandomService","exceptionService"]}(window,angular);