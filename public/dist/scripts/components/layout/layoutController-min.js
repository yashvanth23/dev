+function(a,e){"use strict";function t(t,o,r,i,n,s,d,c,l){t.initFunction=function(){try{t.tab="upcoming",t.matchLoader=!0,t.sidemenu=!1,t.loginStatus=!1,t.backdrop=!1,t.loginEnable=!1,t.registerEnable=!1,t.loginSubmit=!1,t.registerSubmit=!1,t.footerHide=!1,t.user={username:"",password:""},t.userDetail={email:"",password:"",dob:"",username:""};var e=n.get("userInfo");void 0!=e&&(a.sessionStorage.userDetail=e),void 0!=a.sessionStorage.userDetail&&""!=a.sessionStorage.userDetail&&(t.userInfo=JSON.parse(a.sessionStorage.userDetail),t.loginStatus=!0),"upcoming"==a.sessionStorage.pageName?t.footerHide=!0:"setting"==a.sessionStorage.pageName?t.footerHide=!0:t.footerHide=!1,t.getUpcomingMatch(),setInterval(function(){t.getUpcomingMatch()},6e4)}catch(a){d.promiseRejectsAfterAWhile(a)}},t.returnIST=function(a){return moment(a).utcOffset("+0530").format("YYYY-MM-DD HH:mm")+":00"},t.getUpcomingMatch=function(){try{if(t.loginStatus){var a=o.appConfig.baseUrl+o.appConfig.upcoming,e=o.appConfig.baseUrl+o.appConfig.getLeaderBoard+"/"+t.userInfo.username,r="",i="";c.all([i=s.get(e),r=s.get(a)]).then(function(){i.then(function(a){a&&"success"==a.data.status&&(t.matchCard=a.data.data.matchCards)}),r.then(function(a){if(a&&"success"==a.data.status){t.upcomingMatch=[];for(var e=0;e<a.data.data.length;e++)t.upcomingMatch.push({competition:a.data.data[e].season.competition.name,home:a.data.data[e].team1.name,away:a.data.data[e].team2.name,homeLogo:a.data.data[e].team1.logo,awayLogo:a.data.data[e].team2.logo,matchId:a.data.data[e].match.matchId,starts:a.data.data[e].match.startingDateTime,_id:a.data.data[e].match._id,picked:-1!=t.matchCard.indexOf(a.data.data[e].match._id),teams:{team1:a.data.data[e].team1,team2:a.data.data[e].team2},match:{lineup:a.data.data[e].match.lineup}});t.calculateViewport(t.upcomingMatch),t.matchLoader=!1}else t.upcomingMatch=a.data.error})})}else{var n=o.appConfig.baseUrl+o.appConfig.upcoming;s.get(n).then(function(a){if(a&&"success"==a.data.status){t.upcomingMatch=[];for(var e=0;e<a.data.data.length;e++)t.upcomingMatch.push({competition:a.data.data[e].season.competition.name,home:a.data.data[e].team1.name,away:a.data.data[e].team2.name,homeLogo:a.data.data[e].team1.logo,awayLogo:a.data.data[e].team2.logo,matchId:a.data.data[e].match.matchId,starts:a.data.data[e].match.startingDateTime,_id:a.data.data[e].match._id,picked:!1,teams:{team1:a.data.data[e].team1,team2:a.data.data[e].team2},match:{lineup:a.data.data[e].match.lineup}});t.calculateViewport(t.upcomingMatch),t.matchLoader=!1}else t.upcomingMatch=a.data.error})}}catch(a){d.promiseRejectsAfterAWhile(a)}},t.getLiveMatch=function(){try{var a=o.appConfig.baseUrl+o.appConfig.liveMatch;t.loginStatus?s.get(a).then(function(a){if(a&&"success"==a.data.status){t.liveMatch=[];for(var e=0;e<a.data.data.length;e++)t.liveMatch.push({competition:a.data.data[e].season.competition.name,home:a.data.data[e].team1.name,away:a.data.data[e].team2.name,homeLogo:a.data.data[e].team1.logo,awayLogo:a.data.data[e].team2.logo,matchId:a.data.data[e].match.matchId,starts:a.data.data[e].match.startingDateTime,teams:{team1:a.data.data[e].team1,team2:a.data.data[e].team2},picked:-1!=t.matchCard.indexOf(a.data.data[e].match._id)});t.calculateViewport(t.liveMatch),t.matchLoader=!1}else r.showError("#errorModal",a.data.error,!0)},function(a){r.showError("#errorModal",a,!0)}):s.get(a).then(function(a){if(a&&"success"==a.data.status){t.liveMatch=[];for(var e=0;e<a.data.data.length;e++)t.liveMatch.push({competition:a.data.data[e].season.competition.name,home:a.data.data[e].team1.name,away:a.data.data[e].team2.name,homeLogo:a.data.data[e].team1.logo,awayLogo:a.data.data[e].team2.logo,matchId:a.data.data[e].match.matchId,starts:a.data.data[e].match.startingDateTime,teams:{team1:a.data.data[e].team1,team2:a.data.data[e].team2},picked:!1});t.calculateViewport(t.liveMatch),t.matchLoader=!1}else r.showError("#errorModal",a.data.error,!0)},function(a){r.showError("#errorModal",a,!0)})}catch(a){d.promiseRejectsAfterAWhile(a)}},t.getHistoryMatch=function(){try{var a=o.appConfig.baseUrl+o.appConfig.historyMatch;t.loginStatus?s.get(a).then(function(a){if(a&&"success"==a.data.status){t.historyMatch=[];for(var e=0;e<a.data.data.length;e++)t.historyMatch.push({competition:a.data.data[e].season.competition.name,home:a.data.data[e].team1.name,away:a.data.data[e].team2.name,homeLogo:a.data.data[e].team1.logo,awayLogo:a.data.data[e].team2.logo,matchId:a.data.data[e].match.matchId,starts:a.data.data[e].match.startingDateTime,homeScore:a.data.data[e].match.team1Score,awayScore:a.data.data[e].match.team2Score,teams:{team1:a.data.data[e].team1,team2:a.data.data[e].team2},picked:-1!=t.matchCard.indexOf(a.data.data[e].match._id)});t.calculateViewport(t.historyMatch),t.matchLoader=!1}else r.showError("#errorModal",a.data.error,!0)},function(a){r.showError("#errorModal",a,!0)}):s.get(a).then(function(a){if(a&&"success"==a.data.status){t.historyMatch=[];for(var e=0;e<a.data.data.length;e++)t.historyMatch.push({competition:a.data.data[e].season.competition.name,home:a.data.data[e].team1.name,away:a.data.data[e].team2.name,homeLogo:a.data.data[e].team1.logo,awayLogo:a.data.data[e].team2.logo,matchId:a.data.data[e].match.matchId,starts:a.data.data[e].match.startingDateTime,homeScore:a.data.data[e].match.team1Score,awayScore:a.data.data[e].match.team2Score,teams:{team1:a.data.data[e].team1,team2:a.data.data[e].team2},picked:!1});t.calculateViewport(t.historyMatch),t.matchLoader=!1}else r.showError("#errorModal",a.data.error,!0)},function(a){r.showError("#errorModal",a,!0)})}catch(a){d.promiseRejectsAfterAWhile(a)}},t.setTab=function(a){t.tab=a,"live"===a?(t.matchLoader=!0,t.getLiveMatch()):"history"===a?(t.matchLoader=!0,t.getHistoryMatch()):(t.matchLoader=!0,t.getUpcomingMatch())},t.isActiveTab=function(a){return t.tab==a},t.calculateViewport=function(a){a.length>3?e.element(".sidenav-content").addClass("sidenav-content-flow"):e.element(".sidenav-content").removeClass("sidenav-content-flow")},t.gotoPage=function(i,n,s,c){try{var l;t.loginStatus?"upcoming"===s?(t.pagename="upcoming",a.sessionStorage.pageName="upcoming",l=JSON.stringify(n),e.element("li.upcomingmatch").removeClass("active"),e.element("#"+c.target.id).addClass("active"),a.sessionStorage.match=JSON.stringify(n),o.matchChange=n,o.loader=!0,r.navigate("layout.upcoming",l,!1)):"live"===s?(t.pagename="live",a.sessionStorage.pageName="live",l=JSON.stringify(n),e.element("li.upcomingmatch").removeClass("active"),e.element("#"+c.target.id).addClass("active"),a.sessionStorage.match=JSON.stringify(n),o.liveChange=n,r.navigate("layout.live",l,!1)):(t.pagename="history",a.sessionStorage.pageName="history",l=JSON.stringify(n),e.element("li.upcomingmatch").removeClass("active"),e.element("#"+c.target.id).addClass("active"),a.sessionStorage.match=JSON.stringify(n),o.historyChange=n,r.navigate("layout.history",l,!1)):(a.sessionStorage.match=JSON.stringify(n),o.matchChange=n,t.redirecturl={index:i,match:n,tabStatus:s,element:c},t.authEnable("login"))}catch(a){d.promiseRejectsAfterAWhile(a)}},t.menuOpen=function(){t.sidemenu?t.sidemenu=!1:t.sidemenu=!0},t.gotoNavigate=function(e){t.sidemenu=!1,t.pagename=e,a.sessionStorage.pageName=e,"profile"===e?r.navigate("layout.profile","",!1):"store"===e?r.navigate("layout.store","",!1):"point"===e?r.navigate("layout.points","",!1):"rules"===e?r.navigate("layout.rules","",!1):"contact"===e?r.navigate("layout.contact","",!1):"home"==e?r.navigate("layout.dashboard","",!1):r.navigate("layout.setting","",!1)},t.login=function(e){if(t.loginSubmit=!0,e)if(t.agree){o.loader=!0;var i=o.appConfig.baseUrl+o.appConfig.login;s.post(i,t.user).then(function(e){if(e&&"success"==e.data.status){o.loader=!1,t.loginStatus=!0,a.sessionStorage.userDetail=JSON.stringify(e.data.data),n.put("userInfo",a.sessionStorage.userDetail),t.closeAuth(),t.userInfo=e.data.data;JSON.stringify(a.sessionStorage.match);t.redirecturl?t.gotoPage(t.redirecturl.index,t.redirecturl.match,t.redirecturl.tabStatus,t.redirecturl.element):r.navigate("layout.dashboard",{},!1),t.getUpcomingMatch()}else o.loader=!1,t.loginauthError=e.data.error,r.showError("#errorModal",t.loginauthError,!0)})}else r.showError("#warningModal","Please Agree the Terms of Use",!0)},t.register=function(e){if(t.registerSubmit=!0,e)if(t.agreeRegister){o.loader=!0;var i=o.appConfig.baseUrl+o.appConfig.register;s.post(i,t.userDetail).then(function(e){o.loader=!1,e&&"success"==e.data.status?(t.loginStatus=!0,a.sessionStorage.userDetail=JSON.stringify(e.data.data),n.put("userInfo",a.sessionStorage.userDetail),t.userInfo=e.data.data,t.closeAuth(),t.redirecturl?t.gotoPage(t.redirecturl.index,t.redirecturl.match,t.redirecturl.tabStatus,t.redirecturl.element):r.navigate("layout.dashboard",{},!1),t.getUpcomingMatch()):(t.error="",'{ "dob": "Invalid dob" }'==e.data.error?t.error="Invalid Date Of Birth. Please Select Valid Date Of Birth !":'{ "username": "Invalid username" }'==e.data.error?t.error="UserName Already taken. Please Use Another Username !":'{ "dob": "Invalid dob", "username": "Invalid username" }'==e.data.error?t.error="UserName Already taken And Invalid Date Of Birth !":t.error=e.data.error,r.showError("#errorModal",t.error,!0))})}else r.showError("#warningModal","Please Agree the Terms of Use",!0)},t.authEnable=function(a){t.sidemenu=!1,t.loginEnable=!0,e.element(".auth-container").css({opacity:"1",display:"block"}),t.backdrop=!0,"login"==a?(t.loginEnable=!0,t.registerEnable=!1):(t.loginEnable=!1,t.registerEnable=!0)},t.closeAuth=function(){e.element(".auth-container").css({opacity:"0",display:"none"}),t.user={username:"",password:""},t.userDetail={email:"",password:"",dob:"",username:""},t.agree=!1,t.agreeRegister=!1,t.backdrop=!1,t.registerSubmit=!1,t.loginSubmit=!1},t.sucesssClose=function(){e.element("#successModal").removeClass("active"),e.element(".circle-loader").removeClass("load-complete"),e.element(".checkmark").css({display:"none"}),o.customLoader=!1},t.errorClose=function(){e.element("#errorModal").removeClass("active"),o.customLoader=!1},t.closeWarning=function(){e.element("#warningModal").removeClass("active"),o.customLoader=!1},t.openSideMenu=function(){t.sidemenu=!1,e.element(".responsive-sidemenutab").animate({left:"0",opacity:"1"}),e.element(".responsive-sidemenutab .backdrop").css({display:"block"})},t.closeSideMenu=function(){e.element(".responsive-sidemenutab").animate({left:"-400px",opacity:"0"}),e.element(".responsive-sidemenutab .backdrop").css({display:"none"})},t.signupWithGoogle=function(){if(t.agree){var a={clientid:"436866997850-hm9udard1dquu5vjd6g2i8pgvtn7h0qq.apps.googleusercontent.com",cookiepolicy:"single_host_origin",callback:"loginCallback",approvalprompt:"force",requestvisibleactions:"http://schemas.google.com/AddActivity",scope:"https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/plus.profile.emails.read"};gapi.auth.signIn(a)}else r.showError("#warningModal","Please Agree the Terms of Use",!0)},a.loginCallback=function(a){console.log(a),a.status.signed_in&&gapi.client.load("plus","v1",function(){gapi.client.plus.people.get({userId:"me"}).execute(function(a){console.log(a)})})},t.signupWithFacebook=function(){t.agree?FB.login(function(a){a.authResponse?FB.api("/me",{locale:"en_US",fields:"id,first_name,last_name,email,link,gender,locale,picture,birthday"},function(a){console.log(a);var e={username:a.first_name+a.last_name,email:a.email,gender:a.gender,dob:a.birthday,avatar:a.picture.data.url};console.log(e),t.socialRegister(e)}):console.log("User cancelled login or did not fully authorize.")},{scope:"email"}):r.showError("#warningModal","Please Agree the Terms of Use",!0)},t.socialRegister=function(e){console.log(e),o.loader=!1;var i=o.appConfig.baseUrl+o.appConfig.register,d={username:e.username,email:e.email,dob:e.dob,password:"",avatar:e.avatar};s.post(i,d).then(function(e){o.loader=!0,e&&"success"==e.data.status?(t.loginStatus=!0,a.sessionStorage.userDetail=JSON.stringify(e.data.data),n.put("userInfo",a.sessionStorage.userDetail),t.redirecturl?t.gotoPage(t.redirecturl.index,t.redirecturl.match,t.redirecturl.tabStatus.$scope.redirecturl.element):r.navigate("layout.dashboard",{},!1),t.getUpcomingMatch(),t.closeAuth()):r.showError("#errorModal",e.data.error,!0)},function(a){r.showError("#errorModal",a,!0)})},t.logout=function(){n.remove("userInfo"),a.sessionStorage.clear(),t.sidemenu=!1,t.loginStatus=!1,r.navigate("layout.dashboard",{},!1)},t.showTermsOfCondition=function(){e.element("#termsCondition").css({display:"block",opacity:"1"}),o.customLoader=!0},t.closeTermsOfCondition=function(){e.element("#termsCondition").css({display:"none",opacity:"0"}),o.customLoader=!1},t.$watch("pagename",function(){"upcoming"==a.sessionStorage.pageName?t.footerHide=!0:"setting"==a.sessionStorage.pageName?t.footerHide=!0:t.footerHide=!1}),t.initFunction()}e.module("fandom").registerCtrl("layoutController",t),t.$inject=["$scope","$rootScope","$commons","$logger","$cookies","fandomService","exceptionService","$q","$interval"]}(window,angular);